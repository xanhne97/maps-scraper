{% extends "layout.html" %}
{% block content %}

<div class="content-header">
  <div class="container-fluid">
    <h3 class="mb-4">üîç T√¨m ki·∫øm doanh nghi·ªáp theo v·ªã tr√≠ & t·ª´ kh√≥a</h3>

    <form method="POST" action="/">
      <div class="form-group">
        <label for="keywords">T·ª´ kh√≥a t√¨m ki·∫øm (m·ªói d√≤ng 1 t·ª´):</label>
        <textarea name="keywords" id="keywords" class="form-control" rows="4" placeholder="V√≠ d·ª•: s·ª≠a xe Qu·∫≠n 9&#10;qu√°n cafe Th·ªß ƒê·ª©c">{{ request.form.keywords }}</textarea>
      </div>

      <div class="form-group">
        <label for="street_filter">T√™n ƒë∆∞·ªùng c·∫ßn l·ªçc (v√≠ d·ª•: L√™ VƒÉn Vi·ªát):</label>
        <input type="text" name="street_filter" class="form-control" value="{{ request.form.street_filter }}">
      </div>

      <div class="form-row">
        <div class="form-group col-md-4">
          <label for="center_lat">Vƒ© ƒë·ªô trung t√¢m (latitude):</label>
          <input type="text" name="center_lat" class="form-control" placeholder="10.845" value="{{ request.form.center_lat }}">
        </div>
        <div class="form-group col-md-4">
          <label for="center_lng">Kinh ƒë·ªô trung t√¢m (longitude):</label>
          <input type="text" name="center_lng" class="form-control" placeholder="106.794" value="{{ request.form.center_lng }}">
        </div>
        <div class="form-group col-md-4">
          <label for="radius_km">B√°n k√≠nh t√¨m ki·∫øm (km):</label>
          <input type="number" step="0.1" name="radius_km" class="form-control" placeholder="5" value="{{ request.form.radius_km }}">
        </div>
      </div>

      <button type="submit" class="btn btn-primary">
        <i class="fas fa-search"></i> T√¨m ki·∫øm
      </button>
    </form>
  </div>
</div>

<div class="container-fluid mt-4">
  {% if data %}
  <div class="card">
    <div class="card-header bg-success text-white">
      <h5 class="card-title">K·∫øt qu·∫£ t√¨m ki·∫øm ({{ data|length }})</h5>
    </div>
    <div class="card-body table-responsive p-0">
      <table class="table table-bordered table-hover text-nowrap">
        <thead>
          <tr>
            <th>#</th>
            <th>T√™n</th>
            <th>ƒê·ªãa ch·ªâ</th>
            <th>ƒêi·ªán tho·∫°i</th>
            <th>Website</th>
            <th>Lat</th>
            <th>Lng</th>
          </tr>
        </thead>
        <tbody>
          {% for item in data %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ item.title or '-' }}</td>
            <td>{{ item.address or '-' }}</td>
            <td>{{ item.phone or '-' }}</td>
            <td>
              {% if item.website %}
              <a href="{{ item.website }}" target="_blank">Xem</a>
              {% else %}-{% endif %}
            </td>
            <td>{{ item.lat or '-' }}</td>
            <td>{{ item.lng or '-' }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    <div class="card-footer">
      <a href="/download" class="btn btn-success">
        <i class="fas fa-file-excel"></i> T·∫£i k·∫øt qu·∫£ Excel
      </a>
    </div>
  </div>
  {% elif request.method == 'POST' %}
    <div class="alert alert-warning mt-3">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£.</div>
  {% endif %}
</div>

{% endblock %}
