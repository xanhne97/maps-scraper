{% extends "layout.html" %}
{% block content %}

<div class="content-header">
  <div class="container-fluid">
    <h3 class="mb-4">ğŸ“ TÃ¬m kiáº¿m Ä‘á»‹a Ä‘iá»ƒm trÃªn Google Maps theo tá»« khÃ³a, vá»‹ trÃ­ vÃ  bÃ¡n kÃ­nh</h3>

    <!-- Form tÃ¬m kiáº¿m -->
    <form method="POST" action="/">
      <div class="form-group">
        <label for="keywords">Tá»« khÃ³a (má»—i dÃ²ng má»™t tá»«):</label>
        <textarea name="keywords" id="keywords" class="form-control" rows="4" placeholder="VÃ­ dá»¥: sá»­a xe, quÃ¡n cafe">{{ request.form.keywords }}</textarea>
      </div>

      <div class="form-row">
        <div class="form-group col-md-4">
          <label for="lat">VÄ© Ä‘á»™ (Latitude):</label>
          <input type="text" class="form-control" name="lat" id="lat" placeholder="10.9451" value="{{ request.form.lat or '' }}">
        </div>
        <div class="form-group col-md-4">
          <label for="lng">Kinh Ä‘á»™ (Longitude):</label>
          <input type="text" class="form-control" name="lng" id="lng" placeholder="106.8123" value="{{ request.form.lng or '' }}">
        </div>
        <div class="form-group col-md-4">
          <label for="radius_km">BÃ¡n kÃ­nh tÃ¬m kiáº¿m (km):</label>
          <input type="number" step="0.1" class="form-control" name="radius_km" id="radius_km" placeholder="VÃ­ dá»¥: 2" value="{{ request.form.radius_km or '' }}">
        </div>
      </div>

      <div class="form-group">
        <label for="street_filter">Lá»c theo tÃªn Ä‘Æ°á»ng (tuá»³ chá»n):</label>
        <input type="text" class="form-control" name="street_filter" id="street_filter" placeholder="VÃ­ dá»¥: Nguyá»…n Ãi Quá»‘c" value="{{ request.form.street_filter or '' }}">
      </div>

      <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i> TÃ¬m kiáº¿m</button>
    </form>
  </div>
</div>

<!-- Káº¿t quáº£ -->
<div class="container-fluid mt-4">
  {% if data %}
  <div class="card">
    <div class="card-header bg-success">
      <h5 class="card-title text-white">âœ… Káº¿t quáº£ tÃ¬m kiáº¿m ({{ data|length }})</h5>
    </div>
    <div class="card-body table-responsive p-0">
      <table class="table table-hover text-nowrap">
        <thead>
          <tr>
            <th>#</th>
            <th>TÃªn</th>
            <th>Äá»‹a chá»‰</th>
            <th>Äiá»‡n thoáº¡i</th>
            <th>Website</th>
          </tr>
        </thead>
        <tbody>
          {% for item in data %}
          <tr>
            <td>{{ loop.index }}</td>
            <td>{{ item.title or "-" }}</td>
            <td>{{ item.address or "-" }}</td>
            <td>{{ item.phone or "-" }}</td>
            <td>
              {% if item.website %}
                <a href="{{ item.website }}" target="_blank">Xem</a>
              {% else %}
                -
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card-footer">
      <a href="/download" class="btn btn-success"><i class="fas fa-file-excel"></i> Táº£i Excel</a>
    </div>
  </div>
  {% elif request.method == 'POST' %}
    <div class="alert alert-warning">KhÃ´ng tÃ¬m tháº¥y káº¿t quáº£ phÃ¹ há»£p.</div>
  {% endif %}
</div>

{% endblock %}
